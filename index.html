<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>群聊</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    
    <!-- Tailwind 配置 -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#4F46E5',
                        secondary: '#10B981',
                        neutral: '#64748B',
                        light: '#F1F5F9',
                        dark: '#1E293B'
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .message-appear {
                animation: fadeIn 0.3s ease-out forwards;
            }
            .scrollbar-hide {
                scrollbar-width: none;
                -ms-overflow-style: none;
            }
            .scrollbar-hide::-webkit-scrollbar {
                display: none;
            }
            .header-gradient {
                background: linear-gradient(135deg, #4F46E5 0%, #7C3AED 100%);
            }
            .pulse-dot {
                animation: pulse 2s infinite;
            }
            .system-message {
                animation: fadeIn 0.5s ease-out, pulse 2s infinite 1s;
            }
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes pulse {
            0% {
                transform: scale(0.95);
                box-shadow: 0 0 0 0 rgba(79, 70, 229, 0.7);
            }
            
            70% {
                transform: scale(1);
                box-shadow: 0 0 0 6px rgba(79, 70, 229, 0);
            }
            
            100% {
                transform: scale(0.95);
                box-shadow: 0 0 0 0 rgba(79, 70, 229, 0);
            }
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen font-sans text-dark">
    <div class="max-w-4xl mx-auto bg-white shadow-xl rounded-lg overflow-hidden h-screen flex flex-col">
        <!-- 美化后的聊天室头部 -->
        <header class="header-gradient text-white p-4 shadow-lg relative overflow-hidden">
            <!-- 装饰元素 -->
            <div class="absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full -mr-16 -mt-16"></div>
            <div class="absolute bottom-0 left-0 w-24 h-24 bg-white/10 rounded-full -ml-12 -mb-12"></div>
            
            <div class="flex items-center justify-between relative z-10">
                <div class="flex items-center space-x-3">
                    <div class="bg-white/20 p-2 rounded-lg backdrop-blur-sm">
                        <i class="fa fa-comments text-xl"></i>
                    </div>
                    <h1 class="text-xl font-bold tracking-wide">群聊</h1>
                </div>
                <div class="flex items-center space-x-3">
                    <div class="flex items-center bg-white/10 px-3 py-1.5 rounded-full backdrop-blur-sm text-sm">
                        <span class="w-2 h-2 bg-green-400 rounded-full mr-2 pulse-dot"></span>
                        在线
                    </div>
                    <div class="bg-white/10 px-3 py-1.5 rounded-full backdrop-blur-sm text-sm">
                        5人
                    </div>
                </div>
            </div>
        </header>
        
        <!-- 聊天成员列表 - 仅保留头像图标 -->
        <div class="bg-light px-4 py-2 text-sm border-b flex items-center overflow-x-auto scrollbar-hide">
            <div class="flex -space-x-2">
                <img src="https://picsum.photos/id/64/40/40" alt="我的头像" class="w-8 h-8 rounded-full border-2 border-white" title="我">
                <img src="https://picsum.photos/id/91/40/40" alt="快乐小熊猫的头像" class="w-8 h-8 rounded-full border-2 border-white" title="快乐小熊猫">
                <img src="https://picsum.photos/id/22/40/40" alt="自由的作家的头像" class="w-8 h-8 rounded-full border-2 border-white" title="自由的作家">
                <img src="https://picsum.photos/id/65/40/40" alt="逐梦的飞鸟的头像" class="w-8 h-8 rounded-full border-2 border-white" title="逐梦的飞鸟">
                <img src="https://picsum.photos/id/62/40/40" alt="星辰快乐的头像" class="w-8 h-8 rounded-full border-2 border-white" title="星辰快乐">
            </div>
        </div>
        
        <!-- 聊天消息区域 -->
        <main id="chat-messages" class="flex-1 p-4 overflow-y-auto scrollbar-hide space-y-4">
            <!-- 初始日期显示 -->
        </main>
        
        <!-- 输入区域 -->
        <footer class="p-4 border-t bg-white">
            <form id="message-form" class="flex space-x-2">
                <input 
                    type="text" 
                    id="message-input" 
                    placeholder="输入消息..." 
                    class="flex-1 px-4 py-2 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary transition-all"
                    autocomplete="off"
                >
                <button 
                    type="submit" 
                    class="bg-primary hover:bg-primary/90 text-white p-2 rounded-full w-12 h-12 flex items-center justify-center transition-all transform hover:scale-105 active:scale-95 shadow-md hover:shadow-lg"
                >
                    <i class="fa fa-paper-plane"></i>
                </button>
            </form>
        </footer>
    </div>

    <script>
        // 定义用户数据
        const users = [
            { id: 1, name: '快乐小熊猫', avatar: 'https://picsum.photos/id/91/40/40', stance: 'support' },
            { id: 2, name: '自由的作家', avatar: 'https://picsum.photos/id/22/40/40', stance: 'support' },
            { id: 3, name: '逐梦的飞鸟', avatar: 'https://picsum.photos/id/65/40/40', stance: 'oppose' },
            { id: 4, name: '星辰快乐', avatar: 'https://picsum.photos/id/62/40/40', stance: 'oppose' }
        ];
        
        // 支持观点的消息
        const supportMessages = [
            "你不是只代入婚生子的角度看。从儿童角度看，他没有能力选择出生不出生，他出生了需要得到生存和发展的保障。不然大量非婚生子长期处于被剥夺生活来源，最后还是靠社会救济。",
            "拒绝私生子女继承，才是真正鼓励隐匿、欺骗甚至杀婴，社会成本更高。",
            "怕家产被分？早干嘛去了？立遗嘱、买保险、做信托，有的是办法提前锁钱，别事后哭。",
            "私生子女是无辜的，法律保护儿童没问题。能妒忌私生子的人，大多数，本身也没钱。",
            "每次说私生子不能继承财产，有没有一种可能，私生子假如是你的孩子呢，财产也是你的，你是不是就不一样了。对于人家而言，私的公的，都是他的啊，财产也是人家的，所以人家有什么异议，都是自己的孩子，只是不是你的而已",
            "私生子享有继承权的法律完全公平。每个人生而平等，无论是老宗偷情生的还是他强奸生的，他们本人是无辜的，法律规定他们与婚生子完全平等的继承权利。父母造的孽，不能由孩子承担不利后果，况且一切都是按遗嘱来，别说私生子，人家给隔壁老王，你亲生子也争不过",
            "孩子又没得选自己怎么出生，大人的烂账干嘛让TA背锅？法律不护着，TA以后怎么活？",
            "案件归案件，这个法条本身也有原因，不该把怨气撒在无辜孩子身上。谁犯错谁买单，孩子只是孩子。"
        ];
        
        // 不支持观点的消息
        const opposeMessages = [
            "不管谁说的对谁说的假的。我觉得私生子都不应该分走家产。如果私生子分走家产都成了合法的，那么婚姻不成了摆设，以后哪个都得担心自己的配偶在外面被人下套或者勾引了",
            "私生子女能有平等继承权的话，你告诉我领那一张结婚证的意义是什么呢？婚姻究竟在保护谁、在控制谁、在使谁受益？",
            "笑死了，都去当小三吧，有什么罪不牵连子女，子女能还有继承权",
            "这个案子就是对婚姻法最大的亵渎",
            "谁来保证婚生子的权益？保障人的权益优先，私生子是人婚生子就不是人了？",
            "私生子有继承权才是最可笑的，私生子有继承权是哪个私生子通过的？到底是哪个私生子提出这种律例的，古人5000多年来都没有赞同外室或者非婚生子堂而皇之欺负嫡子继承遗产的荒唐，就算是在古代主母的嫁妆在死后也是可以由其亲生子女儿继承的，哪里有庶子和外室子女的份儿。但竟然在现代文明下还出现了这种破天荒的笑话。",
            "出轨生子不犯罪，私生子还有继承权？这是什么导向？不是变相鼓励吗？",
            "以后都别结婚了，把自己弄优秀点，当个有钱人的小三生一堆娃，只要没结婚证负债也不用承担，什么风险都不承担，自己的娃还能和婚生一起分一样的家产"
        ];
        
        // 为每个用户分配4条消息
        const userMessages = {
            1: supportMessages.slice(0, 4),  // 快乐小熊猫 - 支持（前4条）
            2: supportMessages.slice(4, 8),  // 自由的作家 - 支持（后4条）
            3: opposeMessages.slice(0, 4),   // 逐梦的飞鸟 - 不支持（前4条）
            4: opposeMessages.slice(4, 8)    // 星辰快乐 - 不支持（后4条）
        };
        
        // 跟踪每个用户剩余的消息
        const remainingUserMessages = { ...userMessages };
        
        // 收集所有用户ID，用于随机选择发送者
        const allUserIds = users.map(user => user.id);
        
        // DOM 元素
        const chatMessages = document.getElementById('chat-messages');
        const messageForm = document.getElementById('message-form');
        const messageInput = document.getElementById('message-input');
        
        // 初始化 - 添加日期
        function initializeChat() {
            const now = new Date();
            const options = { month: 'short', day: 'numeric', weekday: 'short' };
            const formattedDate = now.toLocaleDateString('zh-CN', options);
            
            const dateDiv = document.createElement('div');
            dateDiv.className = 'text-center message-appear';
            dateDiv.innerHTML = `
                <span class="inline-block bg-gray-200 text-neutral text-xs px-3 py-1 rounded-full">${formattedDate}</span>
            `;
            chatMessages.appendChild(dateDiv);
        }
        
        // 获取当前时间
        function getCurrentTime() {
            const now = new Date();
            return `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;
        }
        
        // 添加消息到聊天区域 - 无颜色标注
        function addMessage(sender, text, isUser = false, isSystem = false) {
            const time = getCurrentTime();
            const messageDiv = document.createElement('div');
            
            if (isSystem) {
                messageDiv.className = 'text-center system-message';
                messageDiv.innerHTML = `
                    <span class="inline-block bg-primary/10 text-primary text-sm px-4 py-2 rounded-full border border-primary/20">
                        ${text}
                    </span>
                `;
            } else if (isUser) {
                messageDiv.className = 'flex justify-end message-appear';
                messageDiv.innerHTML = `
                    <div class="max-w-[70%]">
                        <div class="flex justify-end items-center mb-1">
                            <span class="text-xs text-neutral mr-2">${time}</span>
                            <span class="text-xs font-medium">我</span>
                        </div>
                        <div class="bg-primary text-white p-3 rounded-2xl rounded-tr-none shadow-sm">
                            ${text}
                        </div>
                    </div>
                `;
            } else {
                messageDiv.className = 'flex justify-start message-appear';
                messageDiv.innerHTML = `
                    <img src="${sender.avatar}" alt="${sender.name}的头像" class="w-8 h-8 rounded-full mr-2 mt-1 flex-shrink-0">
                    <div class="max-w-[70%]">
                        <div class="flex items-center mb-1">
                            <span class="text-xs font-medium mr-2">${sender.name}</span>
                            <span class="text-xs text-neutral">${time}</span>
                        </div>
                        <div class="bg-light p-3 rounded-2xl rounded-tl-none shadow-sm">
                            ${text}
                        </div>
                    </div>
                `;
            }
            
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }
        
        // 获取还有消息未发送的用户ID
        function getActiveUsers() {
            return allUserIds.filter(userId => remainingUserMessages[userId].length > 0);
        }
        
        // 发送下一条消息
        function sendNextMessage() {
            // 获取还有消息要发送的用户
            const activeUsers = getActiveUsers();
            
            // 如果没有活跃用户了，显示结束提示并结束发送
            if (activeUsers.length === 0) {
                // 显示系统提示
                addMessage(null, '聊天已结束，各位可返回问卷继续做答', false, true);
                return;
            }
            
            // 随机选择一个活跃用户
            const randomUserId = activeUsers[Math.floor(Math.random() * activeUsers.length)];
            const sender = users.find(user => user.id === randomUserId);
            
            // 获取该用户的下一条消息
            const nextMessage = remainingUserMessages[randomUserId].shift();
            
            // 发送消息
            addMessage(sender, nextMessage);
            
            // 随机生成10-15秒之间的延迟（10000-15000毫秒）
            const nextDelay = 10000 + Math.random() * 5000;
            
            // 安排下一条消息
            setTimeout(sendNextMessage, nextDelay);
        }
        
        // 表单提交处理
        messageForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const messageText = messageInput.value.trim();
            
            if (messageText) {
                addMessage(null, messageText, true);
                messageInput.value = '';
            }
        });
        
        // 允许按Enter发送消息
        messageInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                messageForm.dispatchEvent(new Event('submit'));
            }
        });
        
        // 初始化聊天并开始发送消息
        initializeChat();
        setTimeout(sendNextMessage, 1000);
    </script>
</body>
</html>
    